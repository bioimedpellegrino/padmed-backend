{% extends 'layouts/base-triage.html' %}

{% block title %} Receptions {% endblock title %}

<!-- Specific CSS goes HERE -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}
<!-- Header container -->
  <div class="container-fluid">
    <div class="row"><div class="col-md-12 mb-5"></div></div>
    <div class="row header-bar">
        <div class="col-md-2 "></div>
        <div class="col-md-1">
            <div class="com-triangle-left"></div>
        </div>
        <div class="col-md-6">
            <span><b>RITIRA I TUOI RISULTATI!</b></span>
        </div>
        <div class="col-md-1">
            <div class="com-triangle-right"></div>
        </div>
        <div class="col-md-2"></div>
    </div>
  </div>
<!-- Header container -->
<!-- Main communication div -->
  <div class="com-area">
    <div class="com-area-triangle"></div>
    <div class="com-area-out" style="text-align:center;">
      <img src="/static/assets/img/triage/Print.png">
    </div>
    <div class="row">
      <div class="col-md-4"></div>
      <div class="col-md-4" style="text-align:center;">
        <h3>I TUOI RISULTATI VERRANNO STAMPATI A BREVE</h3>
      </div>
      <div class="col-md-4"></div>
    </div>
    <div class="row">
      <div class="col-md-4"></div>
      <div class="col-md-4" style="text-align:center;">
        <h1>GRAZIE!</h1>
      </div>
      <div class="col-md-4"></div>
    </div>
    <div class="row">
      <div class="col-md-4"></div>
      <div class="col-md-4" style="text-align:center;">
        <img src="/static/assets/img/triage/smile.png">
      </div>
      <div class="col-md-4"></div>
    </div>
  </div>
  <button id="printer" onclick="sendToQuickPrinterChrome();" style="display:none">Stampa risultati</button>
  <button id="returnHome" action ="{% url 'receptions'%}" style="display:none">Procedi con una nuova misurazione</button>
  {% if show_arrow %}
  <div class="row full-bottom-left">
      <img src="/static/assets/img/triage/arrow90.png" onclick="sendToQuickPrinterChrome();">
    </div>
  {% endif %}

<!-- Main communication div -->
{% endblock content %}

<!-- Specific JS goes HERE --> 
{% block javascripts %}

<script>
  function sendToQuickPrinterChrome(){
    var commandsToPrint =
                         "<BIG><BOLD><CENTER> PADMED <BR>\n" +
                         "<CENTER>Esito misurazione<BR>\n" +
                         "<CENTER>Data:" + '{{date}}' +"<BR>\n" +
                         "<BOLD>Misurazione:" +
                         "<BR>\n" +
                         "<LEFT><BOLD>Battito cardiaco:" + '{{measure.measure.HB_BPM.value}}' + '{{measure.measure.HB_BPM.unit}}' +
                         "<BR>\n" +
                         "<LEFT><BOLD>SNR:" +'{{measure.measure.SNR.value}}' + '{{measure.measure.SNR.unit}}' +
                         "<BR>\n" +
                         "<CUT>\n"
                 ;
     var textEncoded = encodeURI(commandsToPrint);
     window.location.href="intent://"+textEncoded+"#Intent;scheme=quickprinter;package=pe.diegoveloper.printerserverapp;end;";
 }

 function printResult(){
  printer = document.getElementById("printer");
  printer.click();
 }

 function returnHome(){
  returnHome = document.getElementById("returnHome");
  returnHome.click();
 }

 const printerTimeout = setTimeout(printResult, 7000);
 const returnHomeTimeout = setTimeout(returnHome, 30000);

</script>

{% endblock javascripts %}
